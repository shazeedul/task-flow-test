"use strict";(self.webpackChunk_am5=self.webpackChunk_am5||[]).push([[1239],{7984:function(e,t,n){function r(e,t){return Array.from({length:t-e},(t,n)=>e+n)}function i(e){return function(t,n){return e(t.source.value+t.target.value,n.source.value+n.target.value)}}function a(){return l(!1,!1)}function o(){return l(!0,!1)}function l(e,t){function n(n){var i,u=n.length,c=new Array(u),f=r(0,u),d=new Array(u*u),h=new Array(u),g=0;n=Float64Array.from({length:u*u},t?(e,t)=>n[t%u][t/u|0]:(e,t)=>n[t/u|0][t%u]);for(let t=0;t<u;++t){let r=0;for(let i=0;i<u;++i)r+=n[t*u+i]+e*n[i*u+t];g+=c[t]=r}i=(g=oe(0,ae-a*u)/g)?a:ae/u;{let t=0;o&&f.sort((e,t)=>o(c[e],c[t]));for(const a of f){const o=t;if(e){const e=r(1+~u,u).filter(e=>e<0?n[~e*u+a]:n[a*u+e]);l&&e.sort((e,t)=>l(e<0?-n[~e*u+a]:n[a*u+e],t<0?-n[~t*u+a]:n[a*u+t]));for(const r of e)r<0?(d[~r*u+a]||(d[~r*u+a]={source:null,target:null})).target={index:a,startAngle:t,endAngle:t+=n[~r*u+a]*g,value:n[~r*u+a]}:(d[a*u+r]||(d[a*u+r]={source:null,target:null})).source={index:a,startAngle:t,endAngle:t+=n[a*u+r]*g,value:n[a*u+r]};h[a]={index:a,startAngle:o,endAngle:t,value:c[a]}}else{const e=r(0,u).filter(e=>n[a*u+e]||n[e*u+a]);l&&e.sort((e,t)=>l(n[a*u+e],n[a*u+t]));for(const r of e){let e;if(a<r?(e=d[a*u+r]||(d[a*u+r]={source:null,target:null}),e.source={index:a,startAngle:t,endAngle:t+=n[a*u+r]*g,value:n[a*u+r]}):(e=d[r*u+a]||(d[r*u+a]={source:null,target:null}),e.target={index:a,startAngle:t,endAngle:t+=n[a*u+r]*g,value:n[a*u+r]},a===r&&(e.source=e.target)),e.source&&e.target&&e.source.value<e.target.value){const t=e.source;e.source=e.target,e.target=t}}h[a]={index:a,startAngle:o,endAngle:t,value:c[a]}}t+=i}}return(d=Object.values(d)).groups=h,s?d.sort(s):d}var a=0,o=null,l=null,s=null;return n.padAngle=function(e){return arguments.length?(a=oe(0,e),n):a},n.sortGroups=function(e){return arguments.length?(o=e,n):o},n.sortSubgroups=function(e){return arguments.length?(l=e,n):l},n.sortChords=function(e){return arguments.length?(null==e?s=null:(s=i(e))._=e,n):s&&s._},n}function s(e){return function(){return e}}function u(e){return e.source}function c(e){return e.target}function f(e){return e.radius}function d(e){return e.startAngle}function h(e){return e.endAngle}function g(){return 0}function p(){return 10}function b(e){function t(){var t,s=n.apply(this,arguments),u=r.apply(this,arguments),c=p.apply(this,arguments)/2,f=ue.call(arguments),d=+i.apply(this,(f[0]=s,f)),h=o.apply(this,f)-ie,g=l.apply(this,f)-ie,y=+a.apply(this,(f[0]=u,f)),v=o.apply(this,f)-ie,m=l.apply(this,f)-ie;if(b||(b=t=(0,se.Z)()),c>le&&(ee(g-h)>2*c+le?g>h?(h+=c,g-=c):(h-=c,g+=c):h=g=(h+g)/2,ee(m-v)>2*c+le?m>v?(v+=c,m-=c):(v-=c,m+=c):v=m=(v+m)/2),b.moveTo(d*te(h),d*ne(h)),b.arc(0,0,d,h,g),h!==v||g!==m)if(e){var k=+e.apply(this,arguments),w=y-k,_=(v+m)/2;b.quadraticCurveTo(0,0,w*te(v),w*ne(v)),b.lineTo(y*te(_),y*ne(_)),b.lineTo(w*te(m),w*ne(m))}else b.quadraticCurveTo(0,0,y*te(v),y*ne(v)),b.arc(0,0,y,v,m);if(b.quadraticCurveTo(0,0,d*te(h),d*ne(h)),b.closePath(),t)return b=null,t+""||null}var n=u,r=c,i=f,a=f,o=d,l=h,p=g,b=null;return e&&(t.headRadius=function(n){return arguments.length?(e="function"==typeof n?n:s(+n),t):e}),t.radius=function(e){return arguments.length?(i=a="function"==typeof e?e:s(+e),t):i},t.sourceRadius=function(e){return arguments.length?(i="function"==typeof e?e:s(+e),t):i},t.targetRadius=function(e){return arguments.length?(a="function"==typeof e?e:s(+e),t):a},t.startAngle=function(e){return arguments.length?(o="function"==typeof e?e:s(+e),t):o},t.endAngle=function(e){return arguments.length?(l="function"==typeof e?e:s(+e),t):l},t.padAngle=function(e){return arguments.length?(p="function"==typeof e?e:s(+e),t):p},t.source=function(e){return arguments.length?(n=e,t):n},t.target=function(e){return arguments.length?(r=e,t):r},t.context=function(e){return arguments.length?(b=null==e?null:e,t):b},t}function y(){return b()}function v(){return b(p)}function m(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function k(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function w(e){return{type:e}}function _(e,t,n){this.k=e,this.x=t,this.y=n}function P(e,t){let n=0;if(void 0===t)for(let t of e)(t=+t)&&(n+=t);else{let r=-1;for(let i of e)(i=+t(i,++r,e))&&(n+=i)}return n}function O(e,t){let n;if(void 0===t)for(const t of e)null!=t&&(n<t||void 0===n&&t>=t)&&(n=t);else{let r=-1;for(let i of e)null!=(i=t(i,++r,e))&&(n<i||void 0===n&&i>=i)&&(n=i)}return n}function A(e,t){let n;if(void 0===t)for(const t of e)null!=t&&(n>t||void 0===n&&t>=t)&&(n=t);else{let r=-1;for(let i of e)null!=(i=t(i,++r,e))&&(n>i||void 0===n&&i>=i)&&(n=i)}return n}function j(e){return e.target.depth}function x(e){return e.depth}function N(e,t){return t-1-e.height}function L(e,t){return e.sourceLinks.length?e.depth:t-1}function I(e){return e.targetLinks.length?e.depth:e.sourceLinks.length?A(e.sourceLinks,j)-1:0}function D(e){return function(){return e}}function T(e,t){return C(e.source,t.source)||e.index-t.index}function S(e,t){return C(e.target,t.target)||e.index-t.index}function C(e,t){return e.y0-t.y0}function R(e){return e.value}function G(e){return e.index}function M(e){return e.nodes}function F(e){return e.links}function W(e,t){const n=e.get(t);if(!n)throw new Error("missing: "+t);return n}function B({nodes:e}){for(const t of e){let e=t.y0,n=e;for(const n of t.sourceLinks)n.y0=e+n.width/2,e+=n.width;for(const e of t.targetLinks)e.y1=n+e.width/2,n+=e.width}}function Y(){function e(){const e={nodes:I.apply(null,arguments),links:Y.apply(null,arguments)};return t(e),n(e),r(e),i(e),a(e),B(e),e}function t({nodes:e,links:t}){for(const[t,n]of e.entries())n.index=t,n.sourceLinks=[],n.targetLinks=[];const n=new Map(e.map((t,n)=>[x(t,n,e),t]));for(const[e,r]of t.entries()){r.index=e;let{source:t,target:i}=r;"object"!=typeof t&&(t=r.source=W(n,t)),"object"!=typeof i&&(i=r.target=W(n,i)),t.sourceLinks.push(r),i.targetLinks.push(r)}if(null!=y)for(const{sourceLinks:t,targetLinks:n}of e)t.sort(y),n.sort(y)}function n({nodes:e}){for(const t of e)t.value=void 0===t.fixedValue?Math.max(P(t.sourceLinks,R),P(t.targetLinks,R)):t.fixedValue}function r({nodes:e}){const t=e.length;let n=new Set(e),r=new Set,i=0;for(;n.size;){for(const e of n){e.depth=i;for(const{target:t}of e.sourceLinks)r.add(t)}if(++i>t)throw new Error("circular link");n=r,r=new Set}}function i({nodes:e}){const t=e.length;let n=new Set(e),r=new Set,i=0;for(;n.size;){for(const e of n){e.height=i;for(const{source:t}of e.targetLinks)r.add(t)}if(++i>t)throw new Error("circular link");n=r,r=new Set}}function a(e){const t=function({nodes:e}){const t=O(e,e=>e.depth)+1,n=(k-v-_)/(t-1),r=new Array(t);for(const i of e){const e=Math.max(0,Math.min(t-1,Math.floor(N.call(null,i,t))));i.layer=e,i.x0=v+e*n,i.x1=i.x0+_,r[e]?r[e].push(i):r[e]=[i]}if(b)for(const e of r)e.sort(b);return r}(e);p=Math.min(j,(w-m)/(O(t,e=>e.length)-1)),function(e){const t=A(e,e=>(w-m-(e.length-1)*p)/P(e,R));for(const n of e){let e=m;for(const r of n){r.y0=e,r.y1=e+r.value*t,e=r.y1+p;for(const e of r.sourceLinks)e.width=e.value*t}e=(w-e+p)/(n.length+1);for(let t=0;t<n.length;++t){const r=n[t];r.y0+=e*(t+1),r.y1+=e*(t+1)}d(n)}}(t);for(let e=0;e<Z;++e){const n=Math.pow(.99,e),r=Math.max(1-n,(e+1)/Z);l(t,n,r),o(t,n,r)}}function o(e,t,n){for(let r=1,i=e.length;r<i;++r){const i=e[r];for(const e of i){let n=0,r=0;for(const{source:t,value:i}of e.targetLinks){let a=i*(e.layer-t.layer);n+=h(t,e)*a,r+=a}if(!(r>0))continue;let i=(n/r-e.y0)*t;e.y0+=i,e.y1+=i,f(e)}void 0===b&&i.sort(C),s(i,n)}}function l(e,t,n){for(let r=e.length-2;r>=0;--r){const i=e[r];for(const e of i){let n=0,r=0;for(const{target:t,value:i}of e.sourceLinks){let a=i*(t.layer-e.layer);n+=g(e,t)*a,r+=a}if(!(r>0))continue;let i=(n/r-e.y0)*t;e.y0+=i,e.y1+=i,f(e)}void 0===b&&i.sort(C),s(i,n)}}function s(e,t){const n=e.length>>1,r=e[n];c(e,r.y0-p,n-1,t),u(e,r.y1+p,n+1,t),c(e,w,e.length-1,t),u(e,m,0,t)}function u(e,t,n,r){for(;n<e.length;++n){const i=e[n],a=(t-i.y0)*r;a>1e-6&&(i.y0+=a,i.y1+=a),t=i.y1+p}}function c(e,t,n,r){for(;n>=0;--n){const i=e[n],a=(i.y1-t)*r;a>1e-6&&(i.y0-=a,i.y1-=a),t=i.y0-p}}function f({sourceLinks:e,targetLinks:t}){if(void 0===y){for(const{source:{sourceLinks:e}}of t)e.sort(S);for(const{target:{targetLinks:t}}of e)t.sort(T)}}function d(e){if(void 0===y)for(const{sourceLinks:t,targetLinks:n}of e)t.sort(S),n.sort(T)}function h(e,t){let n=e.y0-(e.sourceLinks.length-1)*p/2;for(const{target:r,width:i}of e.sourceLinks){if(r===t)break;n+=i+p}for(const{source:r,width:i}of t.targetLinks){if(r===e)break;n-=i}return n}function g(e,t){let n=t.y0-(t.targetLinks.length-1)*p/2;for(const{source:r,width:i}of t.targetLinks){if(r===e)break;n+=i+p}for(const{target:r,width:i}of e.sourceLinks){if(r===t)break;n-=i}return n}let p,b,y,v=0,m=0,k=1,w=1,_=24,j=8,x=G,N=L,I=M,Y=F,Z=6;return e.update=function(e){return B(e),e},e.nodeId=function(t){return arguments.length?(x="function"==typeof t?t:D(t),e):x},e.nodeAlign=function(t){return arguments.length?(N="function"==typeof t?t:D(t),e):N},e.nodeSort=function(t){return arguments.length?(b=t,e):b},e.nodeWidth=function(t){return arguments.length?(_=+t,e):_},e.nodePadding=function(t){return arguments.length?(j=p=+t,e):j},e.nodes=function(t){return arguments.length?(I="function"==typeof t?t:D(t),e):I},e.links=function(t){return arguments.length?(Y="function"==typeof t?t:D(t),e):Y},e.linkSort=function(t){return arguments.length?(y=t,e):y},e.size=function(t){return arguments.length?(v=m=0,k=+t[0],w=+t[1],e):[k-v,w-m]},e.extent=function(t){return arguments.length?(v=+t[0][0],k=+t[1][0],m=+t[0][1],w=+t[1][1],e):[[v,m],[k,w]]},e.iterations=function(t){return arguments.length?(Z=+t,e):Z},e}n.r(t),n.d(t,{Chord:function(){return je},ChordDirected:function(){return Ne},ChordLink:function(){return Oe},ChordLinkDirected:function(){return xe},ChordNodes:function(){return we},ChordNonRibbon:function(){return Le},DefaultTheme:function(){return H},Flow:function(){return U},FlowLink:function(){return Pe},FlowNode:function(){return be},FlowNodes:function(){return ye},Sankey:function(){return Me},SankeyLink:function(){return Te},SankeyNodes:function(){return De}});var Z=n(5125),z=n(3409),E=n(6245),V=n(2754),Q=n(3783),X=n(5071),H=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,Z.ZT)(t,e),Object.defineProperty(t.prototype,"setupDefaultRules",{enumerable:!1,configurable:!0,writable:!0,value:function(){e.prototype.setupDefaultRules.call(this);var t,n=this._root.interfaceColors,r=this.rule.bind(this);r("Flow").setAll({width:E.AQ,height:E.AQ,paddingLeft:10,paddingRight:10,paddingTop:10,paddingBottom:10}),r("FlowNodes").setAll({colors:V.U.new(this._root,{}),legendLabelText:"{name}",legendValueText:"{sumOutgoing.formatNumber('#.#')}"}),r("FlowNode").setAll({}),r("FlowNode",["unknown"]).setAll({draggable:!1,opacity:0}),r("RadialLabel",["flow","node"]).setAll({text:"{name}",populateText:!0}),r("FlowLink").setAll({fillStyle:"gradient",strokeStyle:"gradient"}),r("FlowLink",["source","unknown"]).setAll({}),r("FlowLink",["target","unknown"]).setAll({}),r("FlowNode").events.on("pointerover",function(e){var t=e.target.dataItem;if(t){var n=t.get("outgoingLinks");n&&X.each(n,function(e){var t=e.get("link");t.hover(),t.hideTooltip()});var r=t.get("incomingLinks");r&&X.each(r,function(e){var t=e.get("link");t.hover(),t.hideTooltip()})}var i=t.get("slice")||t.get("rectangle");i&&i.get("tooltipText")&&i.showTooltip()}),r("FlowNode").events.on("pointerout",function(e){var t=e.target.dataItem;if(t){var n=t.get("outgoingLinks");n&&X.each(n,function(e){e.get("link").unhover()});var r=t.get("incomingLinks");r&&X.each(r,function(e){e.get("link").unhover()})}}),r("Sankey").setAll({orientation:"horizontal",nodeAlign:"justify",linkTension:.5,nodePadding:10,nodeWidth:10}),r("RoundedRectangle",["sankey","node","shape"]).setAll({cornerRadiusTL:0,cornerRadiusBL:0,cornerRadiusTR:0,cornerRadiusBR:0}),r("SankeyLink").setAll({controlPointDistance:.2}),r("FlowNode",["sankey"]).setAll({draggable:!0}),(t=r("Graphics",["sankey","link"])).setAll({fillOpacity:.2,strokeOpacity:0,interactive:!0,tooltipText:"{sourceId} - {targetId}: {value}"}),(0,Q.v)(t,"fill",n,"grid"),r("Graphics",["sankey","link"]).states.create("hover",{fillOpacity:.5}),r("Label",["sankey","node"]).setAll({text:"{name}",populateText:!0}),r("Label",["sankey","horizontal"]).setAll({y:E.CI,centerY:E.CI,paddingLeft:15}),r("Label",["sankey","vertical"]).setAll({x:E.CI,centerX:E.CI,paddingTop:15}),r("Chord").setAll({radius:(0,E.aQ)(90),nodeWidth:10,padAngle:1,startAngle:0,sort:"descending"}),r("ChordDirected").setAll({linkHeadRadius:10}),r("ChordNodes").setAll({x:E.CI,y:E.CI}),r("FlowNode",["chord"]).setAll({draggable:!0}),r("ChordLink").setAll({sourceRadius:E.AQ,targetRadius:E.AQ,fillStyle:"solid",strokeStyle:"solid",tooltipText:"{sourceId} - {targetId}: {value}"}),r("Slice",["chord","node","shape"]).setAll({cornerRadius:0}),r("RadialLabel",["chord","node"]).setAll({radius:5,textType:"circular"}),r("ChordLinkDirected").setAll({headRadius:10}),(t=r("Graphics",["chord","link","shape"])).setAll({fillOpacity:.2,strokeOpacity:0,interactive:!0}),(0,Q.v)(t,"fill",n,"grid"),(0,Q.v)(t,"stroke",n,"grid"),r("Graphics",["chord","link","shape"]).states.create("hover",{fillOpacity:.5}),r("ChordNonRibbon").setAll({linkType:"curve"}),r("ChordLink",["basic"]).setAll({fillStyle:"none",strokeStyle:"source"}),r("Graphics",["chord","link","shape","basic"]).setAll({strokeOpacity:.4}),r("Graphics",["chord","link","shape","basic"]).states.create("hover",{strokeWidth:2,strokeOpacity:1})}}),t}(z.Q),q=n(3399),J=n(8777),$=n(1747),K=n(5040),U=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return Object.defineProperty(t,"linksContainer",{enumerable:!0,configurable:!0,writable:!0,value:t.children.push(J.W.new(t._root,{}))}),Object.defineProperty(t,"_nodesData",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(t,"_linksData",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(t,"_index",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(t,"_nodesDataSet",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(t,"_linksByIndex",{enumerable:!0,configurable:!0,writable:!0,value:{}}),t}return(0,Z.ZT)(t,e),Object.defineProperty(t.prototype,"_afterNew",{enumerable:!1,configurable:!0,writable:!0,value:function(){this._defaultThemes.push(H.new(this._root)),this.fields.push("disabled","sourceId","targetId"),this.nodes&&(this.nodes.flow=this),e.prototype._afterNew.call(this),this.children.push(this.bulletsContainer)}}),Object.defineProperty(t.prototype,"processDataItem",{enumerable:!1,configurable:!0,writable:!0,value:function(t){e.prototype.processDataItem.call(this,t);var n=this.nodes;if(n){var r=!1,i=t.get("sourceId"),a=n.getDataItemById(i);a||(null==i&&(i="undefined"+this._index,this._index++,r=!0),n.data.push({id:i,unknown:r}),a=n.getDataItemById(i),r||a.set("name",i)),r=!1;var o=t.get("targetId"),l=n.getDataItemById(o);l||(null==o&&(o="undefined"+this._index,this._index++,r=!0),n.data.push({id:o,unknown:r}),l=n.getDataItemById(o),r||l.set("name",o)),a&&(t.set("source",a),n.addOutgoingLink(a,t)),l&&(t.set("target",l),n.addincomingLink(l,t)),t.set("link",this.makeLink(t));var s=this.nodes.dataItems.indexOf(a),u=this.nodes.dataItems.indexOf(l);this._linksByIndex[s+"_"+u]=t,a.get("unknown")&&(l&&a.set("fill",l.get("fill")),t.get("link").set("fillStyle","gradient")),l.get("unknown")&&(a&&l.set("fill",a.get("fill")),t.get("link").set("fillStyle","gradient")),this._updateLinkColor(t)}}}),Object.defineProperty(t.prototype,"_onDataClear",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.nodes._userDataSet||(this.nodes.data.setAll([]),this.nodes._userDataSet=!1)}}),Object.defineProperty(t.prototype,"_prepareChildren",{enumerable:!1,configurable:!0,writable:!0,value:function(){var t=this;e.prototype._prepareChildren.call(this);var n=1/0,r=-1/0,i=0;if(this._valuesDirty){this._nodesData=[];var a=this.nodes;a&&X.each(a.dataItems,function(e){var n=e.get("d3SankeyNode");t._nodesData.push(n);var r=e.get("incomingLinks"),i=0,o=0;r&&X.each(r,function(e){var t=e.get("value"),n=e.get("valueWorking");i+=t,o+=n}),e.set("sumIncoming",i),e.set("sumIncomingWorking",o);var l=e.get("outgoingLinks"),s=0,u=0;l&&X.each(l,function(e){var t=e.get("value"),n=e.get("valueWorking");s+=t,u+=n}),e.set("sumOutgoing",s),e.set("sumOutgoingWorking",u),e.set("sum",i+s),e.set("sumWorking",o+u),a.updateLegendValue(e)}),this._linksData=[],X.each(this.dataItems,function(e){var t=e.get("value");K.isNumber(t)&&(t<n&&(n=t),t>r&&(r=t),i+=t)}),X.each(this.dataItems,function(e){var n=e.get("value");if(K.isNumber(n)){var r=e.get("valueWorking"),a=t.get("minSize",0);a>0&&r<a*i&&(r=a*i);var o={source:e.get("source").get("d3SankeyNode"),target:e.get("target").get("d3SankeyNode"),value:r};e.setRaw("d3SankeyLink",o),t._linksData.push(o),t.updateLegendValue(e)}}),this.setPrivateRaw("valueHigh",r),this.setPrivateRaw("valueLow",n),this.setPrivateRaw("valueSum",i)}}}),Object.defineProperty(t.prototype,"_updateLinkColor",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=e.get("link"),n=t.get("fillStyle"),r=t.get("strokeStyle"),i=e.get("source"),a=e.get("target"),o=i.get("fill"),l=a.get("fill");switch(t.remove("fillGradient"),t.remove("strokeGradient"),n){case"solid":t._applyTemplates();break;case"source":t.set("fill",o);break;case"target":t.set("fill",l);break;case"gradient":if(!(c=t._fillGradient)){c=$.o.new(this._root,{});var s={color:o};i.get("unknown")&&(s.opacity=0);var u={color:l};a.get("unknown")&&(u.opacity=0),c.set("stops",[s,u]),t._fillGradient=c}t.set("fillGradient",c);break;case"none":t.set("fill",void 0)}switch(r){case"solid":t._applyTemplates();break;case"source":t.set("stroke",o);break;case"target":t.set("stroke",l);case"gradient":var c;(c=t._strokeGradient)||(c=$.o.new(this._root,{}),s={color:o},i.get("unknown")&&(s.opacity=0),u={color:l},a.get("unknown")&&(u.opacity=0),c.set("stops",[s,u]),t._strokeGradient=c),t.set("strokeGradient",c);break;case"none":t.remove("stroke")}}}),Object.defineProperty(t.prototype,"disposeDataItem",{enumerable:!1,configurable:!0,writable:!0,value:function(t){e.prototype.disposeDataItem.call(this,t);var n=t.get("link");n&&(this.links.removeValue(n),n.dispose())}}),Object.defineProperty(t.prototype,"hideDataItem",{enumerable:!1,configurable:!0,writable:!0,value:function(t,n){return(0,Z.mG)(this,void 0,void 0,function(){var r,i,a,o,l;return(0,Z.Jh)(this,function(s){switch(s.label){case 0:return r=[e.prototype.hideDataItem.call(this,t,n)],i=this.states.create("hidden",{}),a="stateAnimationDuration",o="stateAnimationEasing",K.isNumber(n)||(n=i.get(a,this.get(a,0))),l=i.get(o,this.get(o)),r.push(t.animate({key:"valueWorking",to:0,duration:n,easing:l}).waitForStop()),t.get("link").hide(),[4,Promise.all(r)];case 1:return s.sent(),[2]}})})}}),Object.defineProperty(t.prototype,"showDataItem",{enumerable:!1,configurable:!0,writable:!0,value:function(t,n){return(0,Z.mG)(this,void 0,void 0,function(){var r,i;return(0,Z.Jh)(this,function(a){switch(a.label){case 0:return r=[e.prototype.showDataItem.call(this,t,n)],K.isNumber(n)||(n=this.get("stateAnimationDuration",0)),i=this.get("stateAnimationEasing"),r.push(t.animate({key:"valueWorking",to:t.get("value"),duration:n,easing:i}).waitForStop()),t.get("link").show(),[4,Promise.all(r)];case 1:return a.sent(),[2]}})})}}),Object.defineProperty(t.prototype,"_positionBullet",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=e.get("sprite");if(t){var n=t.dataItem;if(n){var r=n.get("link"),i=e.get("sprite");if(i){var a=r.getPoint(this._getBulletLocation(e));i.setAll({x:a.x,y:a.y}),e.get("autoRotate")&&i.set("rotation",a.angle+e.get("autoRotateAngle",0))}}}}}),Object.defineProperty(t.prototype,"_getBulletLocation",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return e.get("locationY",0)}}),Object.defineProperty(t,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Flow"}),Object.defineProperty(t,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:q.F.classNames.concat([t.className])}),t}(q.F),ee=Math.abs,te=Math.cos,ne=Math.sin,re=Math.PI,ie=re/2,ae=2*re,oe=Math.max,le=1e-12,se=n(5493),ue=Array.prototype.slice;n(7896);const{abs:ce,max:fe,min:de}=Math;["w","e"].map(w),["n","s"].map(w),["n","w","e","s","nw","ne","sw","se"].map(w),_.prototype={constructor:_,scale:function(e){return 1===e?this:new _(this.k*e,this.x,this.y)},translate:function(e,t){return 0===e&0===t?this:new _(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},new _(1,0,0),_.prototype;var he=n(5769),ge=n(7144),pe=n(962),be=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return Object.defineProperty(t,"series",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),t}return(0,Z.ZT)(t,e),Object.defineProperty(t,"className",{enumerable:!0,configurable:!0,writable:!0,value:"FlowNode"}),Object.defineProperty(t,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:J.W.classNames.concat([t.className])}),t}(J.W),ye=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return Object.defineProperty(t,"labels",{enumerable:!0,configurable:!0,writable:!0,value:new ge.o(he.YS.new({}),function(){return pe._._new(t._root,{},[t.labels.template])})}),Object.defineProperty(t,"nodes",{enumerable:!0,configurable:!0,writable:!0,value:new ge.o(he.YS.new({}),function(){return be._new(t._root,{themeTags:["node"]},[t.nodes.template])})}),Object.defineProperty(t,"_userDataSet",{enumerable:!0,configurable:!0,writable:!0,value:!1}),t}return(0,Z.ZT)(t,e),Object.defineProperty(t.prototype,"_afterNew",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.fields.push("unknown","name","fill"),this.set("idField","id"),this.set("nameField","id"),this.set("fillField","fill"),this.set("unknownField","unknown"),this.children.push(this.bulletsContainer),e.prototype._afterNew.call(this)}}),Object.defineProperty(t.prototype,"_onDataClear",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=this.get("colors");e&&e.reset(),this._userDataSet=!0}}),Object.defineProperty(t.prototype,"processDataItem",{enumerable:!1,configurable:!0,writable:!0,value:function(t){if(e.prototype.processDataItem.call(this,t),t.setRaw("d3SankeyNode",{name:t.get("id"),dataItem:t}),null==t.get("fill")){var n=this.get("colors");n&&t.setRaw("fill",n.next())}t.setRaw("node",this.makeNode(t))}}),Object.defineProperty(t.prototype,"makeNode",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){var n=this.nodes.make();return this.nodes.push(n),t&&n.addTag(t),e.get("unknown")&&n.addTag("unknown"),this.children.push(n),n._setDataItem(e),n.series=this,e.set("node",n),n}}),Object.defineProperty(t.prototype,"disposeDataItem",{enumerable:!1,configurable:!0,writable:!0,value:function(t){e.prototype.disposeDataItem.call(this,t);var n=t.get("node");n&&(this.nodes.removeValue(n),n.dispose());var r=t.get("label");r&&(this.labels.removeValue(r),r.dispose())}}),Object.defineProperty(t.prototype,"addincomingLink",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){var n=e.get("incomingLinks");n||(n=[],e.set("incomingLinks",n)),n.push(t)}}),Object.defineProperty(t.prototype,"addOutgoingLink",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){var n=e.get("outgoingLinks");n||(n=[],e.set("outgoingLinks",n)),n.push(t)}}),Object.defineProperty(t.prototype,"showDataItem",{enumerable:!1,configurable:!0,writable:!0,value:function(t,n){return(0,Z.mG)(this,void 0,void 0,function(){var r,i,a,o;return(0,Z.Jh)(this,function(l){switch(l.label){case 0:return r=[e.prototype.showDataItem.call(this,t,n)],(i=this.flow)&&((a=t.get("label"))&&a.show(n),(o=t.get("outgoingLinks"))&&X.each(o,function(e){i.showDataItem(e,n)}),(o=t.get("incomingLinks"))&&X.each(o,function(e){i.showDataItem(e,n)})),[4,r];case 1:return l.sent(),[2]}})})}}),Object.defineProperty(t.prototype,"hideDataItem",{enumerable:!1,configurable:!0,writable:!0,value:function(t,n){return(0,Z.mG)(this,void 0,void 0,function(){var r,i,a,o;return(0,Z.Jh)(this,function(l){switch(l.label){case 0:return r=[e.prototype.hideDataItem.call(this,t,n)],(i=this.flow)&&((a=t.get("label"))&&a.hide(n),(o=t.get("outgoingLinks"))&&X.each(o,function(e){i.hideDataItem(e,n)}),(o=t.get("incomingLinks"))&&X.each(o,function(e){i.hideDataItem(e,n)})),[4,r];case 1:return l.sent(),[2]}})})}}),Object.defineProperty(t,"className",{enumerable:!0,configurable:!0,writable:!0,value:"FlowNodes"}),Object.defineProperty(t,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:q.F.classNames.concat([t.className])}),t}(q.F),ve=n(5863),me=n(815),ke=n(751),we=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return Object.defineProperty(t,"labels",{enumerable:!0,configurable:!0,writable:!0,value:new ge.o(he.YS.new({}),function(){return me.x._new(t._root,{},[t.labels.template])})}),Object.defineProperty(t,"flow",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(t,"_dAngle",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(t,"rectangles",{enumerable:!0,configurable:!0,writable:!0,value:new ge.o(he.YS.new({}),function(){return ve.p._new(t._root,{themeTags:["shape"]},[t.rectangles.template])})}),t}return(0,Z.ZT)(t,e),Object.defineProperty(t.prototype,"makeNode",{enumerable:!1,configurable:!0,writable:!0,value:function(t){var n=this,r=e.prototype.makeNode.call(this,t,"chord"),i=r.children.insertIndex(0,this.rectangles.make());t.set("slice",i),i._setSoft("fill",t.get("fill"));var a=this.labels.make();return this.labels.push(a),a.addTag("flow"),a.addTag("chord"),a.addTag("node"),r.children.push(a),t.set("label",a),r.events.on("dragstart",function(e){var t=n.toLocal(e.point),r=ke.getAngle({x:0,y:0},t);n.flow&&(n._dAngle=n.flow.get("startAngle",0)-r)}),r.events.on("dragged",function(e){var t=n.toLocal(e.point),i=ke.getAngle({x:0,y:0},t);r.setAll({x:0,y:0}),n.flow&&n.flow.set("startAngle",i+n._dAngle)}),a._setDataItem(t),i._setDataItem(t),r}}),Object.defineProperty(t.prototype,"_positionBullet",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=e.get("sprite");if(t){var n=t.dataItem;if(n){var r=e.get("sprite");if(r){var i=n.get("slice"),a=e.get("locationX",.5),o=e.get("locationY",.5);if(i){var l=i.get("radius",0),s=i.get("innerRadius",0),u=s+(l-s)*o,c=i.get("startAngle",0)+i.get("arc",0)*a;r.setAll({x:u*ke.cos(c),y:u*ke.sin(c)})}}}}}}),Object.defineProperty(t,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ChordNodes"}),Object.defineProperty(t,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:ye.classNames.concat([t.className])}),t}(ye),_e=n(1479),Pe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return Object.defineProperty(t,"series",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(t,"_fillGradient",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(t,"_strokeGradient",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),t}return(0,Z.ZT)(t,e),Object.defineProperty(t.prototype,"_changed",{enumerable:!1,configurable:!0,writable:!0,value:function(){if(e.prototype._changed.call(this),this.isDirty("fillStyle")){var t=this.series,n=this.dataItem;t&&n&&t._updateLinkColor(n)}}}),Object.defineProperty(t.prototype,"_getTooltipPoint",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=this.get("tooltipY"),t=.5;return e instanceof E.gG&&(t=e.value),this.getPoint(t)}}),Object.defineProperty(t,"className",{enumerable:!0,configurable:!0,writable:!0,value:"FlowLink"}),Object.defineProperty(t,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:_e.T.classNames.concat([t.className])}),t}(_e.T),Oe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return Object.defineProperty(t,"_p0",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(t,"_p1",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(t,"_type",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),t}return(0,Z.ZT)(t,e),Object.defineProperty(t.prototype,"getPoint",{enumerable:!1,configurable:!0,writable:!0,value:function(e){if(this._p0&&this._p1){if("line"===this._type)return{x:(t=ke.getPointOnLine(this._p0,this._p1,e)).x,y:t.y,angle:ke.getAngle(this._p0,this._p1)};var t,n=ke.getPointOnQuadraticCurve(this._p0,this._p1,{x:0,y:0},Math.max(0,e-.01)),r=ke.getPointOnQuadraticCurve(this._p0,this._p1,{x:0,y:0},Math.min(1,e+.01));return{x:(t=ke.getPointOnQuadraticCurve(this._p0,this._p1,{x:0,y:0},e)).x,y:t.y,angle:ke.getAngle(n,r)}}return{x:0,y:0,angle:0}}}),Object.defineProperty(t,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ChordLink"}),Object.defineProperty(t,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Pe.classNames.concat([t.className])}),t}(Pe),Ae=n(7652),je=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return Object.defineProperty(t,"links",{enumerable:!0,configurable:!0,writable:!0,value:new ge.o(he.YS.new({}),function(){return Oe._new(t._root,{themeTags:["link","shape"]},[t.links.template])})}),Object.defineProperty(t,"nodes",{enumerable:!0,configurable:!0,writable:!0,value:t.children.push(we.new(t._root,{}))}),Object.defineProperty(t,"_d3chord",{enumerable:!0,configurable:!0,writable:!0,value:a()}),Object.defineProperty(t,"_chordLayout",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(t,"_ribbon",{enumerable:!0,configurable:!0,writable:!0,value:y()}),t}return(0,Z.ZT)(t,e),Object.defineProperty(t.prototype,"_afterNew",{enumerable:!1,configurable:!0,writable:!0,value:function(){this._settings.themeTags=Ae.mergeTags(this._settings.themeTags,["chord"]),this.linksContainer.setAll({x:E.CI,y:E.CI}),this.bulletsContainer.setAll({x:E.CI,y:E.CI}),e.prototype._afterNew.call(this)}}),Object.defineProperty(t.prototype,"_fixRibbon",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this;e.startAngle(function(e){return e.startAngle+t.get("startAngle",0)*ke.RADIANS+Math.PI/2}),e.endAngle(function(e){return e.endAngle+t.get("startAngle",0)*ke.RADIANS+Math.PI/2})}}),Object.defineProperty(t.prototype,"makeLink",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this.linksContainer.children.push(this.links.make());return this.links.push(t),t._setDataItem(e),t.set("source",e.get("source")),t.set("target",e.get("target")),t.series=this,t}}),Object.defineProperty(t.prototype,"_makeMatrix",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=this,t=[];return X.each(this.nodes.dataItems,function(n){var r=[];t.push(r);var i=n.get("outgoingLinks");X.each(e.nodes.dataItems,function(t){var n=0;i&&X.each(i,function(r){r.get("target")===t&&(n=r.get("valueWorking"));var i=e.getPrivate("valueSum",0),a=e.get("minSize",0);n>0&&a>0&&n<i*a&&(n=i*a)}),r.push(n)})}),t}}),Object.defineProperty(t.prototype,"_prepareChildren",{enumerable:!1,configurable:!0,writable:!0,value:function(){var t=this;e.prototype._prepareChildren.call(this),this._fixRibbon(this._ribbon);var n=!1;if(this._valuesDirty||this._sizeDirty||this.isDirty("padAngle")||this.isDirty("startAngle")){var r=this._makeMatrix();this._d3chord.padAngle(this.get("padAngle",0)*ke.RADIANS);var i=this.get("sort")
;"ascending"===i?this._d3chord.sortGroups(m):"descending"===i&&this._d3chord.sortGroups(k),this._chordLayout=this._d3chord(r),n=!0}if(n||this.isDirty("radius")||this.isDirty("nodeWidth")){var a=Ae.relativeToValue(this.get("radius",0),Math.min(this.innerWidth(),this.innerHeight()))/2,o=0,l=this.get("startAngle",0),s=this.get("nodeWidth",0);X.each(this.nodes.dataItems,function(e){var n=e.get("slice"),r=t._chordLayout.groups[o],i=r.startAngle*ke.DEGREES+l,u=r.endAngle*ke.DEGREES+l;n.setAll({radius:a,innerRadius:a-s,startAngle:i,arc:u-i});var c=e.get("label");c.setAll({labelAngle:i+(u-i)/2}),c.setPrivate("radius",a),c.setPrivate("innerRadius",.1),o++});var u=a-this.get("nodeWidth",0);X.each(this._chordLayout,function(e){var n=t._linksByIndex[e.source.index+"_"+e.target.index];if(n||(n=t._linksByIndex[e.target.index+"_"+e.source.index]),n){var r=n.get("link");t._getLinkPoints(r,u,e),t._updateLink(t._ribbon,r,u,e)}})}}}),Object.defineProperty(t.prototype,"_getLinkPoints",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,n){var r=n.source,i=n.target,a=this.get("startAngle",0)*ke.RADIANS;if(r&&i){var o=r.startAngle,l=o+(r.endAngle-o)/2+a,s=i.startAngle,u=s+(i.endAngle-s)/2+a;e._p0={x:t*Math.cos(l),y:t*Math.sin(l)},e._p1={x:t*Math.cos(u),y:t*Math.sin(u)}}}}),Object.defineProperty(t.prototype,"_updateLink",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,n,r){r&&(e.sourceRadius(Ae.relativeToValue(t.get("sourceRadius",E.AQ),n)),e.targetRadius(Ae.relativeToValue(t.get("targetRadius",E.AQ),n)),t.set("draw",function(t){e.context(t),e(r)}))}}),Object.defineProperty(t.prototype,"disposeDataItem",{enumerable:!1,configurable:!0,writable:!0,value:function(t){e.prototype.disposeDataItem.call(this,t);var n=t.get("label");n&&n.dispose()}}),Object.defineProperty(t,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Chord"}),Object.defineProperty(t,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:U.classNames.concat([t.className])}),t}(U),xe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,Z.ZT)(t,e),Object.defineProperty(t.prototype,"_afterNew",{enumerable:!1,configurable:!0,writable:!0,value:function(){this._settings.themeTags=Ae.mergeTags(this._settings.themeTags,["chord","link","directed"]),e.prototype._afterNew.call(this)}}),Object.defineProperty(t,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ChordLinkDirected"}),Object.defineProperty(t,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Oe.classNames.concat([t.className])}),t}(Oe),Ne=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return Object.defineProperty(t,"_d3chord",{enumerable:!0,configurable:!0,writable:!0,value:o()}),Object.defineProperty(t,"_ribbonArrow",{enumerable:!0,configurable:!0,writable:!0,value:v()}),Object.defineProperty(t,"links",{enumerable:!0,configurable:!0,writable:!0,value:new ge.o(he.YS.new({}),function(){return xe._new(t._root,{themeTags:["link","shape"]},[t.links.template])})}),t}return(0,Z.ZT)(t,e),Object.defineProperty(t.prototype,"makeLink",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this.linksContainer.children.push(this.links.make());return t._setDataItem(e),t.set("source",e.get("source")),t.set("target",e.get("target")),t.series=this,t}}),Object.defineProperty(t.prototype,"_afterNew",{enumerable:!1,configurable:!0,writable:!0,value:function(){this._settings.themeTags=Ae.mergeTags(this._settings.themeTags,["directed"]),e.prototype._afterNew.call(this),this._markDirtyKey("linkHeadRadius")}}),Object.defineProperty(t.prototype,"_prepareChildren",{enumerable:!1,configurable:!0,writable:!0,value:function(){var t="linkHeadRadius";if(this.isDirty(t)){var n=this.get(t);if(null==n)this._ribbon=y();else{var r=v();r.headRadius(n),this._ribbon=r}}e.prototype._prepareChildren.call(this)}}),Object.defineProperty(t,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ChordDirected"}),Object.defineProperty(t,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:je.classNames.concat([t.className])}),t}(je),Le=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,Z.ZT)(t,e),Object.defineProperty(t.prototype,"_afterNew",{enumerable:!1,configurable:!0,writable:!0,value:function(){this._settings.themeTags=Ae.mergeTags(this._settings.themeTags,["chord","basic"]),e.prototype._afterNew.call(this)}}),Object.defineProperty(t.prototype,"_makeMatrix",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=this,t=[];return X.each(this.nodes.dataItems,function(n){var r=[];t.push(r),X.each(e.nodes.dataItems,function(e){var t=1;n===e&&(t=0),r.push(t)})}),t}}),Object.defineProperty(t.prototype,"_updateLink",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,n,r){if(t._type=this.get("linkType"),r){var i=this.get("linkType");t.set("draw",function(e){var n=t._p0,r=t._p1;n&&r&&(e.moveTo(n.x,n.y),"line"==i?e.lineTo(r.x,r.y):e.quadraticCurveTo(0,0,r.x,r.y))})}}}),Object.defineProperty(t.prototype,"_getLinkPoints",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,n){var r=e.get("source"),i=e.get("target");if(r&&i){var a=r.get("slice"),o=i.get("slice"),l=a.get("startAngle",0)+a.get("arc",0)/2,s=o.get("startAngle",0)+o.get("arc",0)/2;e._p0={x:t*ke.cos(l),y:t*ke.sin(l)},e._p1={x:t*ke.cos(s),y:t*ke.sin(s)}}}}),Object.defineProperty(t,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ChordNonRibbon"}),Object.defineProperty(t,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:je.classNames.concat([t.className])}),t}(je),Ie=n(3497),De=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return Object.defineProperty(t,"rectangles",{enumerable:!0,configurable:!0,writable:!0,value:new ge.o(he.YS.new({}),function(){return Ie.c._new(t._root,{themeTags:["shape"]},[t.rectangles.template])})}),Object.defineProperty(t,"flow",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),t}return(0,Z.ZT)(t,e),Object.defineProperty(t.prototype,"makeNode",{enumerable:!1,configurable:!0,writable:!0,value:function(t){var n=this.flow,r=e.prototype.makeNode.call(this,t,"sankey"),i=r.children.insertIndex(0,this.rectangles.make());this.rectangles.push(i),i._setSoft("fill",t.get("fill")),t.set("rectangle",i),r.events.on("dragged",function(){var e=r.dataItem.get("d3SankeyNode");e&&n&&("horizontal"==n.get("orientation")?(e.x0=r.x(),e.y0=r.y()):(e.x0=r.y(),e.y0=r.x()),n.updateSankey())});var a=this.labels.make();return this.labels.push(a),n&&a.addTag(n.get("orientation","")),r.children.push(a),t.set("label",a),a._setDataItem(t),i._setDataItem(t),r}}),Object.defineProperty(t.prototype,"_positionBullet",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=e.get("sprite");if(t){var n=t.dataItem;if(n){var r=e.get("sprite");if(r){var i=n.get("rectangle"),a=n.get("node"),o=e.get("locationX",.5),l=e.get("locationY",.5);i&&r.setAll({x:a.x()+i.width()*o,y:a.y()+i.height()*l})}}}}}),Object.defineProperty(t.prototype,"disposeDataItem",{enumerable:!1,configurable:!0,writable:!0,value:function(t){e.prototype.disposeDataItem.call(this,t);var n=t.get("rectangle");n&&(this.rectangles.removeValue(n),n.dispose())}}),Object.defineProperty(t,"className",{enumerable:!0,configurable:!0,writable:!0,value:"SankeyNodes"}),Object.defineProperty(t,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:ye.classNames.concat([t.className])}),t}(ye),Te=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return Object.defineProperty(t,"_svgPath",{enumerable:!0,configurable:!0,writable:!0,value:document.createElementNS("http://www.w3.org/2000/svg","path")}),Object.defineProperty(t,"_totalLength",{enumerable:!0,configurable:!0,writable:!0,value:0}),t}return(0,Z.ZT)(t,e),Object.defineProperty(t.prototype,"_beforeChanged",{enumerable:!1,configurable:!0,writable:!0,value:function(){var t,n,r,i,a=this;if(e.prototype._beforeChanged.call(this),this.isDirty("source")){var o=this.get("source");if(o){var l=o.get("node");this._disposers.push(l.events.on("positionchanged",function(){a.markDirty()}))}}if(this.isDirty("target")){var s=this.get("target");if(s){var u=s.get("node");this._disposers.push(u.events.on("positionchanged",function(){a.markDirty()}))}}if(this.isPrivateDirty("orientation")){var c=this.series;(p=this.dataItem)&&c&&c._updateLinkColor(p)}var f,d,h=this.get("target"),g=this.get("source");if(g&&h){this._clear=!0,f=g.get("node"),d=h.get("node");var p,b=0,y=0,v=0,m=0,k=0,w=0,_=0,P=0,O=0,A=0,j=0,x=0,N=0,L=0,I=0,D=0,T=0,S=0;if(p=this.dataItem){var C=p.get("d3SankeyLink");if(C){var R=C.width||0,G=this.getPrivate("orientation");"vertical"==G?(f&&(v=f.y()),d&&(m=d.y()),T=90,S=90,b=C.y0||0,y=C.y1||0,m<v&&(b=(t=(0,Z.CR)([y,b],2))[0],y=t[1],v=(n=(0,Z.CR)([m,v],2))[0],m=n[1]),g.get("unknown")&&(b=y,v+=(m-v)/2),h.get("unknown")&&(y=b,m=v+(m-v)/2),k=b-R/2,w=v,_=y-R/2,P=m,O=b+R/2,A=y+R/2,j=v,x=m,N=b,L=y,I=v,D=m):(f&&(b=f.x()),d&&(y=d.x()),v=C.y0||0,m=C.y1||0,y<b&&(b=(r=(0,Z.CR)([y,b],2))[0],y=r[1],v=(i=(0,Z.CR)([m,v],2))[0],m=i[1]),g.get("unknown")&&(v=m,b+=(y-b)/2),h.get("unknown")&&(m=v,y=b+(y-b)/2),k=b,w=v-R/2,_=y,P=m-R/2,O=b,A=y,j=v+R/2,x=m+R/2,N=b,L=y,I=v,D=m),ke.round(k,3)==ke.round(_,3)&&(_+=.01),ke.round(w,3)==ke.round(P,3)&&(P+=.01),ke.round(O,3)==ke.round(A,3)&&(A+=.01),ke.round(j,3)==ke.round(x,3)&&(x+=.01);var M=this.get("controlPointDistance",.2),F=k+(_-k)*(M=Math.min(.4999,M))*ke.cos(T),W=w+(P-w)*M*ke.sin(T),B=_-(_-k)*M*ke.cos(S),Y=P-(P-w)*M*ke.sin(S),z=N+(L-N)*M*ke.cos(T),E=I+(D-I)*M*ke.sin(T),V=L-(L-N)*M*ke.cos(S),Q=D-(D-I)*M*ke.sin(S),X=ke.getAngle({x:F,y:W},{x:B,y:Y}),H=(R/ke.cos(X)-R)/ke.tan(X)*ke.cos(T),q=(R/ke.sin(X)-R)*ke.tan(X)*ke.sin(T),J=-H/2+O+(A-O)*M*ke.cos(T),$=-q/2+j+(x-j)*M*ke.sin(T),K=-H/2+A-(A-O)*M*ke.cos(S),U=-q/2+x-(x-j)*M*ke.sin(S);F+=H/2,W+=q/2,B+=H/2,Y+=q/2,"vertical"==G?(W=Math.min(P,Math.max(w+1,W)),$=Math.min(x,Math.max(j+1,$)),Y=Math.max(w,Math.min(P-1,Y)),U=Math.max(j,Math.min(x-1,U))):(F=Math.min(_,Math.max(k+1,F)),J=Math.min(A,Math.max(O+1,J)),B=Math.max(k,Math.min(_-1,B)),K=Math.max(O,Math.min(A-1,K)));var ee=[[k,w,O,j],[F,W,J,$],[B,Y,K,U],[_,P,A,x]];this.set("draw",function(e){var t=a.series;t._fillGenerator.context(e),t._fillGenerator(ee)});var te=[[N,I],[z,E],[V,Q],[L,D]],ne=this.series._strokeGenerator(te);ne&&(this._svgPath.setAttribute("d",ne),this._totalLength=this._svgPath.getTotalLength())}}}this.series&&this.dataItem&&this.series._positionBullets(this.dataItem)}}),Object.defineProperty(t.prototype,"getPoint",{enumerable:!1,configurable:!0,writable:!0,value:function(e){if(this._svgPath&&this._svgPath.getAttribute("d")){var t=this._svgPath.getPointAtLength(e*this._totalLength-.1),n=this._svgPath.getPointAtLength(e*this._totalLength+.1),r=this.toGlobal(this._svgPath.getPointAtLength(e*this._totalLength));return{x:r.x,y:r.y,angle:ke.getAngle(t,n)}}return{x:0,y:0,angle:0}}}),Object.defineProperty(t.prototype,"_getTooltipPoint",{enumerable:!1,configurable:!0,writable:!0,value:function(){return this.toLocal(e.prototype._getTooltipPoint.call(this))}}),Object.defineProperty(t,"className",{enumerable:!0,configurable:!0,writable:!0,value:"SankeyLink"}),Object.defineProperty(t,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Pe.classNames.concat([t.className])}),t}(Pe),Se=n(3794),Ce=n(774),Re=n(8289),Ge=n(5892),Me=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return Object.defineProperty(t,"links",{enumerable:!0,configurable:!0,writable:!0,value:new ge.o(he.YS.new({}),function(){return Te._new(t._root,{themeTags:["link","shape"]},[t.links.template])})}),Object.defineProperty(t,"nodes",{enumerable:!0,configurable:!0,writable:!0,value:t.children.push(De.new(t._root,{}))}),Object.defineProperty(t,"_d3Sankey",{enumerable:!0,configurable:!0,writable:!0,value:Y()}),Object.defineProperty(t,"_d3Graph",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(t,"_fillGenerator",{enumerable:!0,configurable:!0,writable:!0,value:(0,Se.Z)()}),Object.defineProperty(t,"_strokeGenerator",{enumerable:!0,configurable:!0,writable:!0,value:(0,Ce.Z)()}),t}return(0,Z.ZT)(t,e),Object.defineProperty(t.prototype,"_afterNew",{enumerable:!1,configurable:!0,writable:!0,value:function(){this._settings.themeTags=Ae.mergeTags(this._settings.themeTags,["sankey",this._settings.orientation||"horizontal"]),this._fillGenerator.y0(function(e){return e[3]}),this._fillGenerator.x0(function(e){return e[2]}),this._fillGenerator.y1(function(e){return e[1]}),this._fillGenerator.x1(function(e){return e[0]}),e.prototype._afterNew.call(this)}}),Object.defineProperty(t.prototype,"makeLink",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=e.get("source"),n=e.get("target"),r=this.links.make();return t.get("unknown")&&(r.addTag("source"),r.addTag("unknown")),n.get("unknown")&&(r.addTag("target"),r.addTag("unknown")),this.linksContainer.children.push(r),r._setDataItem(e),r.set("source",t),r.set("target",n),r.series=this,this.links.push(r),r}}),Object.defineProperty(t.prototype,"updateSankey",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=this,t=this._d3Graph;t&&(this._d3Sankey.update(t),X.each(this.dataItems,function(t){var n=t.get("link");n.setPrivate("orientation",e.get("orientation")),n.markDirty()}))}}),Object.defineProperty(t.prototype,"_updateLinkColor",{enumerable:!1,configurable:!0,writable:!0,value:function(t){e.prototype._updateLinkColor.call(this,t);var n=this.get("orientation"),r=t.get("link")._fillGradient,i=t.get("link")._strokeGradient;"vertical"==n?(r&&r.set("rotation",90),i&&i.set("rotation",90)):(r&&r.set("rotation",0),i&&i.set("rotation",0))}}),Object.defineProperty(t.prototype,"_getBulletLocation",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return"vertical"==this.get("orientation")?e.get("locationY",0):e.get("locationX",0)}}),Object.defineProperty(t.prototype,"_prepareChildren",{enumerable:!1,configurable:!0,writable:!0,value:function(){var t,n=this;e.prototype._prepareChildren.call(this);var r=!1;if("vertical"==this.get("orientation")&&(r=!0),this.isDirty("orientation")||this.isDirty("linkTension")){var i=this.get("linkTension",.5);r?(this._fillGenerator.curve((0,Ge.$)(i)),this._strokeGenerator.curve((0,Ge.$)(i))):(this._fillGenerator.curve((0,Re.G)(i)),this._strokeGenerator.curve((0,Re.G)(i)))}if((this._valuesDirty||this._sizeDirty||this.isDirty("nodePadding")||this.isDirty("nodeWidth")||this.isDirty("nodeAlign")||this.isDirty("nodeSort")||this.isDirty("orientation")||this.isDirty("linkTension"))&&this._nodesData.length>0){var a=this._d3Sankey,o=this.innerWidth(),l=this.innerHeight();switch(r&&(o=(t=(0,Z.CR)([l,o],2))[0],l=t[1]),a.size([o,l]),a.nodePadding(this.get("nodePadding",10)),a.nodeWidth(this.get("nodeWidth",10)),a.nodeSort(this.get("nodeSort",null)),this.get("nodeAlign")){case"right":a.nodeAlign(N);break;case"justify":a.nodeAlign(L);break;case"center":a.nodeAlign(I);break;default:a.nodeAlign(x)}this._d3Graph=a({nodes:this._nodesData,links:this._linksData}),X.each(this.dataItems,function(e){var t=e.get("link");t.setPrivate("orientation",n.get("orientation")),t.markDirty()});var s=this._d3Graph;if(s){var u=s.nodes;X.each(u,function(e){var t,n,i,a,o=e.dataItem,l=o.get("node");r?(t=e.y0,n=e.y1,i=e.x0,a=e.x1):(t=e.x0,n=e.x1,i=e.y0,a=e.y1),K.isNumber(t)&&K.isNumber(n)&&K.isNumber(i)&&K.isNumber(a)&&(l.setAll({x:t,y:i,width:n-t,height:a-i}),o.get("rectangle").setAll({width:n-t,height:a-i}))})}}}}),Object.defineProperty(t,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Sankey"}),Object.defineProperty(t,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:U.classNames.concat([t.className])}),t}(U)},906:function(e,t,n){n.r(t),n.d(t,{am5flow:function(){return r}});const r=n(7984)}},function(e){var t=e(e.s=906),n=window;for(var r in t)n[r]=t[r];t.__esModule&&Object.defineProperty(n,"__esModule",{value:!0})}]);